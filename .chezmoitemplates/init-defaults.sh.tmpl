#!/bin/bash

#################
# load bat external theme
#################

# Function to resolve alias to actual command
resolve_alias() {
  local alias_name="$1"
  local real_command

  # Check if the alias exists
  if alias "$alias_name" &> /dev/null; then
    # Extract the real command from the alias
    real_command=$(alias "$alias_name" | sed -E "s/^alias $alias_name='([^']+)'.*/\1/")
    echo "$real_command"
  else
    echo ""
  fi
}

# Check if bat themes directory exists
if [ ! -d ~/.config/bat/themes ]; then
  echo "Loading external bat theme"

  # Check if batcat or bat is aliased to cat
  batcat_alias=$(resolve_alias 'cat')

  if [[ $batcat_alias == *"batcat"* ]]; then
    eval "$batcat_alias cache --build"
  elif [[ $batcat_alias == *"bat"* ]]; then
    eval "$batcat_alias cache --build"
  elif command -v batcat &> /dev/null; then
    batcat cache --build
  elif command -v bat &> /dev/null; then
    bat cache --build
  else
    echo "bat is not installed"
  fi
else
  echo "The themes directory already exists."
fi


#################
# set zsh to default shell
#################
if [ ! -f ~/.zshrc ]; then
    echo "Set zsh as default shell"
    chsh -s $(which zsh)
else
	echo "zsh already default shell, skipping."
fi